adatok = [
    {
      "OM_Azonosito": "78655218932",
      "Neve": "Szabó Anna",
      "ErtesitesiCime": "Budapest, Gellért tér 15.",
      "Email": "anna@example.com",
      "SzuletesiDatum": "1998-07-19T00:00:00",
      "Matematika": 14,
      "Magyar": 35
    },
    {
      "OM_Azonosito": "15963702584",
      "Neve": "Nagy Zsófia",
      "ErtesitesiCime": "Debrecen, Szent István utca 8.",
      "Email": "zsofia@example.com",
      "SzuletesiDatum": "2000-02-22T00:00:00",
      "Matematika": 27,
      "Magyar": 4
    },
    {
      "OM_Azonosito": "30351479261",
      "Neve": "Kovács Máté",
      "ErtesitesiCime": "Szeged, Erzsébet körút 45.",
      "Email": "mate@example.com",
      "SzuletesiDatum": "1995-11-29T00:00:00",
      "Matematika": 48,
      "Magyar": 15
    },
    {
      "OM_Azonosito": "97401028543",
      "Neve": "Tóth Bence",
      "ErtesitesiCime": "Pécs, Váci utca 33.",
      "Email": "bence@example.com",
      "SzuletesiDatum": "1997-03-17T00:00:00",
      "Matematika": 8,
      "Magyar": 47
    },
    {
      "OM_Azonosito": "88765031624",
      "Neve": "Horváth Eszter",
      "ErtesitesiCime": "Székesfehérvár, Bartók Béla út 12.",
      "Email": "eszter@example.com",
      "SzuletesiDatum": "1996-09-08T00:00:00",
      "Matematika": 34,
      "Magyar": 7
    },
    {
      "OM_Azonosito": "64189075351",
      "Neve": "Kiss Attila",
      "ErtesitesiCime": "Miskolc, József Attila utca 18.",
      "Email": "attila@example.com",
      "SzuletesiDatum": "1993-12-05T00:00:00",
      "Matematika": 13,
      "Magyar": 48
    },
    {
      "OM_Azonosito": "18734250658",
      "Neve": "Fekete Laura",
      "ErtesitesiCime": "Győr, Széchenyi tér 9.",
      "Email": "laura@example.com",
      "SzuletesiDatum": "1999-06-30T00:00:00",
      "Matematika": 2,
      "Magyar": 30
    },
    {
      "OM_Azonosito": "51698072427",
      "Neve": "Bíró Gábor",
      "ErtesitesiCime": "Kecskemét, Deák Ferenc utca 21.",
      "Email": "gabor@example.com",
      "SzuletesiDatum": "1994-10-14T00:00:00",
      "Matematika": 9,
      "Magyar": 33
    },
    {
      "OM_Azonosito": "60157349268",
      "Neve": "Mészáros Péter",
      "ErtesitesiCime": "Nyíregyháza, Petőfi Sándor utca 26.",
      "Email": "peter@example.com",
      "SzuletesiDatum": "2001-04-01T00:00:00",
      "Matematika": 36,
      "Magyar": 21
    },
    {
      "OM_Azonosito": "72948316750",
      "Neve": "Varga Noémi",
      "ErtesitesiCime": "Szombathely, Kossuth Lajos utca 3.",
      "Email": "noemi@example.com",
      "SzuletesiDatum": "1992-08-18T00:00:00",
      "Matematika": 24,
      "Magyar": 23
    },
    {
      "OM_Azonosito": "84052731649",
      "Neve": "Lakatos Dóra",
      "ErtesitesiCime": "Veszprém, Ady Endre utca 7.",
      "Email": "dora@example.com",
      "SzuletesiDatum": "2000-01-03T00:00:00",
      "Matematika": 43,
      "Magyar": 41
    },
    {
      "OM_Azonosito": "85273941680",
      "Neve": "Németh Tamás",
      "ErtesitesiCime": "Szolnok, Béke tér 14.",
      "Email": "tamas@example.com",
      "SzuletesiDatum": "1998-05-27T00:00:00",
      "Matematika": 5,
      "Magyar": 49
    },
    {
      "OM_Azonosito": "41593260701",
      "Neve": "Orbán Katalin",
      "ErtesitesiCime": "Eger, Szabadság utca 32.",
      "Email": "katalin@example.com",
      "SzuletesiDatum": "1996-02-11T00:00:00",
      "Matematika": 37,
      "Magyar": 20
    },
    {
      "OM_Azonosito": "10486732952",
      "Neve": "Simon Balázs",
      "ErtesitesiCime": "Debrecen, Király utca 28.",
      "Email": "balazs@example.com",
      "SzuletesiDatum": "1995-07-07T00:00:00",
      "Matematika": 20,
      "Magyar": 48
    },
    {
      "OM_Azonosito": "92740581643",
      "Neve": "Papp Viktória",
      "ErtesitesiCime": "Kaposvár, Alkotmány utca 5.",
      "Email": "viktor@example.com",
      "SzuletesiDatum": "1997-11-24T00:00:00",
      "Matematika": 32,
      "Magyar": 9
    },
    {
      "OM_Azonosito": "10637851454",
      "Neve": "Molnár Zoltán",
      "ErtesitesiCime": "Szekszárd, Párizsi utca 17.",
      "Email": "zoltan@example.com",
      "SzuletesiDatum": "1993-01-16T00:00:00",
      "Matematika": 3,
      "Magyar": 46
    },
    {
      "OM_Azonosito": "44025967885",
      "Neve": "Fekete Márton",
      "ErtesitesiCime": "Pécs, Rákóczi út 13.",
      "Email": "marton@example.com",
      "SzuletesiDatum": "1992-04-29T00:00:00",
      "Matematika": 42,
      "Magyar": 31
    },
    {
      "OM_Azonosito": "30381425616",
      "Neve": "Pál Júlia",
      "ErtesitesiCime": "Sopron, Szent Gellért tér 10.",
      "Email": "julia@example.com",
      "SzuletesiDatum": "1999-09-02T00:00:00",
      "Matematika": 49,
      "Magyar": 19
    },
    {
      "OM_Azonosito": "65082317920",
      "Neve": "Takács Orsolya",
      "ErtesitesiCime": "Eger, Andrássy út 22.",
      "Email": "orsolya@example.com",
      "SzuletesiDatum": "1994-06-13T00:00:00",
      "Matematika": 31,
      "Magyar": 18
    },
    {
      "OM_Azonosito": "15374680221",
      "Neve": "Kovács Ádám",
      "ErtesitesiCime": "Székesfehérvár, Bajnai út 8.",
      "Email": "adam@example.com",
      "SzuletesiDatum": "1996-08-06T00:00:00",
      "Matematika": 18,
      "Magyar": 10
    }
]
rendezettAdatok=adatok
let vegsoLista=[]
FeltoltTablat()


function FeltoltTablat(){
  let talalat = false
    document.getElementById("tablatest").innerHTML = ""

    vegsoLista=[]

    if (document.getElementById("nevszuro").value != "") {
          rendezettAdatok.forEach(sor=>{
      if (sor.Neve.substring(0,document.getElementById("nevszuro").value.length) == document.getElementById("nevszuro").value.substring(0,document.getElementById("nevszuro").value.length)) {
        vegsoLista.push(sor)
      }
    })
    }

    if (document.getElementById("nevszuro").value.length == 0) {
      vegsoLista = rendezettAdatok
    }/*
    if (vegsoLista.length == 1) {
      rendezettAdatok.forEach(sor=>{
        if (sor.Magyar + sor.Matematika >= vegsoLista[0].Magyar + vegsoLista[0].Matematika) {
          vegsoLista.push(sor)
        }
      })
      talalat = true
    }
*/

    vegsoLista.forEach(sor => {
        if (sor.Matematika + sor.Magyar >= document.getElementById("pontszam").value) {
            document.getElementById("tablatest").innerHTML += 
            `<tr>
                <td>${sor.OM_Azonosito}</td>
                <td>${sor.Neve}</td>
                <td>${sor.Matematika}</td>
                <td>${sor.Magyar}</td>
                <td>${sor.Matematika + sor.Magyar}</td>
            </tr>`
        }
    });
    atlag(vegsoLista)
    return vegsoLista;
    /*
    if (talalat) {
      console.log("a")
      document.getElementById("tablatest").children[0].remove()
}*/
}

function rendezesMatek(){
    frissitClass("matek")

    if (document.getElementById("matek").classList.contains("rendezett")) {
        rendezettAdatok = adatok.sort(function(a, b){
            return b.Matematika - a.Matematika
        })
        document.getElementById("matek").classList.remove("rendezett")
    }
    else{
        rendezettAdatok = adatok.sort(function(a, b){
            return a.Matematika - b.Matematika
        })
        document.getElementById("matek").classList.add("rendezett") 
    }

    FeltoltTablat()
}

function rendezesMagyar(){
    frissitClass("magyar")
    if (document.getElementById("magyar").classList.contains("rendezett")) {
        rendezettAdatok = adatok.sort(function(a, b){
            return b.Magyar - a.Magyar
        })
        document.getElementById("magyar").classList.remove("rendezett")
    }
    else{
        rendezettAdatok = adatok.sort(function(a, b){
            return a.Magyar - b.Magyar
        })
        document.getElementById("magyar").classList.add("rendezett") 
    }
    FeltoltTablat()
}

function rendezesOsszes(){
    frissitClass("osszes")
    if (document.getElementById("osszes").classList.contains("rendezett")) {
        rendezettAdatok = adatok.sort(function(a, b){
            return (b.Matematika + b.Magyar) - (a.Matematika + a.Magyar)
        })
        document.getElementById("osszes").classList.remove("rendezett")
    }
    else{
        rendezettAdatok = adatok.sort(function(a, b){
            return (a.Matematika + a.Magyar) - (b.Matematika + b.Magyar)
        })
        document.getElementById("osszes").classList.add("rendezett") 
    }
    FeltoltTablat()
}

function rendezesNev(){
    frissitClass("nev")

    if (document.getElementById("nev").classList.contains("rendezett")) {
        rendezettAdatok = adatok.sort(function(a, b){
            if (a.Neve < b.Neve) {return 1}
            else if(a.Neve > b.Neve){return -1}
            else{return 0}
        })
        document.getElementById("nev").classList.remove("rendezett")
    }
    else{
        rendezettAdatok = adatok.sort(function(a, b){
            if (a.Neve > b.Neve) {return 1}
            else if(a.Neve < b.Neve){return -1}
            else{return 0}
        })
        document.getElementById("nev").classList.add("rendezett") 
    }



    FeltoltTablat()
}

function rendezesOM(){
    frissitClass("om")
    if (document.getElementById("om").classList.contains("rendezett")) {
        rendezettAdatok = adatok.sort(function(a, b){
            return b.OM_Azonosito - a.OM_Azonosito
        })
        document.getElementById("om").classList.remove("rendezett")
    }
    else{
        rendezettAdatok = adatok.sort(function(a, b){
            return a.OM_Azonosito - b.OM_Azonosito
        })
        document.getElementById("om").classList.add("rendezett") 
    }
    FeltoltTablat() 
}

function frissitClass(eztNe) {
    if (eztNe != "matek") {
        document.getElementById("matek").classList.remove("rendezett")
    }
    if (eztNe != "magyar") {
        document.getElementById("magyar").classList.remove("rendezett")
    }
    if (eztNe != "om") {
        document.getElementById("om").classList.remove("rendezett")
    }
    if (eztNe != "osszes") {
        document.getElementById("osszes").classList.remove("rendezett")
    }
    if (eztNe != "nev") {
        document.getElementById("nev").classList.remove("rendezett")
    }
}


function atlag(lista){
  let osszeg = [0, 0, 0]
  let atlag = 0
  let db = 0
  lista.forEach(elem=>{
    if (elem.Matematika + elem.Magyar >= document.getElementById("pontszam").value) {
      osszeg[0]+=elem.Matematika
      osszeg[1]+=elem.Magyar
      osszeg[2] = osszeg[0] + osszeg[1]
      db++
    }
  })
  document.getElementById("liMatek").innerText = "Matek: " + Math.round(osszeg[0]/db, 2)
  document.getElementById("liMagyar").innerText = "Magyar: " + Math.round(osszeg[0]/db, 2)
  document.getElementById("liOsszes").innerText = "Összes: " + Math.round(osszeg[2]/db, 2)
}

/*
      "OM_Azonosito": "78655218932",
      "Neve": "Szabó Anna",
      "ErtesitesiCime": "Budapest, Gellért tér 15.",
      "Email": "anna@example.com",
      "SzuletesiDatum": "1998-07-19T00:00:00",
      "Matematika": 14,
      "Magyar": 35
*/
function masol(){
  let szoveg=""
  FeltoltTablat().forEach(elem=>{
    szoveg+=`${elem.OM_Azonosito};${elem.Neve};${elem.Email};${elem.SzuletesiDatum};${elem.ErtesitesiCime};${elem.Matematika};${elem.Magyar}\n`
  })
  navigator.clipboard.writeText(szoveg);
}

